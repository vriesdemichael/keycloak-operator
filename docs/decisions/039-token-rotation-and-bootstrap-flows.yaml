number: 39
title: Token rotation and bootstrap flows
category: architecture
decision: Support token rotation for delegation tokens and provide bootstrap flows
  for initial setup. Tokens can be rotated without disrupting existing resources.
agent_instructions: Design token system to support rotation. When tokens are rotated,
  update resources referencing old tokens to use new ones. Provide bootstrap flows
  for initial token creation (operator creates initial realm token, realm creates
  initial client tokens). Document rotation procedures and automation.
rationale: Token rotation is security best practice. Long-lived tokens increase compromise
  risk. Rotation support allows enforcing token expiration policies. Bootstrap flows
  enable automated initial setup without manual token distribution. Smooth rotation
  (no downtime) ensures tokens can be rotated regularly. Automation reduces operational
  burden of token management.
provenance: human
rejected_alternatives:
- alternative: Non-rotatable tokens
  reason: Security risk. Compromised tokens can't be invalidated without recreating
    all resources.
- alternative: Manual token distribution only
  reason: Doesn't scale. Error-prone. Slows down initial setup and emergency rotation.
