number: 45
title: Active-standby HA using Kopf peering
category: architecture
decision: Support high availability via active-standby replication (replicas > 1)
  using Kopf's built-in peering mechanism. One replica is active (leader), others
  are standby. Standby replicas take over if active fails. This is for availability,
  not workload capacity scaling.
agent_instructions: Operator supports active-standby HA via Kopf peering. Increasing
  replicas improves availability but does NOT increase reconciliation capacity.
rationale: Kopf provides built-in active-standby HA via peering - minimal implementation
  effort. One active replica processes all events, standbys are ready to take over.
  Prevents downtime during upgrades or failures. Operator is stateless so failover
  is fast and safe. HA is justified for production environments where brief reconciliation
  pauses are unacceptable. Standby replicas are not wasted - they provide fault tolerance.
  Important distinction - this HA mechanism does NOT improve throughput or capacity.
  Keycloak API is almost certainly the bottleneck, not the operator.
provenance: human
rejected_alternatives:
- alternative: No HA (single replica only)
  reason: Acceptable for dev/test but production environments benefit from availability
    during upgrades and failures.
- alternative: Active-active with work distribution
  reason: Very complex to implement. Risk of conflicts and split-brain. Kopf's active-standby
    is simpler and sufficient for availability needs.
