{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "type": "object",
  "properties": {
    "realmName": {
      "type": "string",
      "description": "Name of the Keycloak realm"
    },
    "displayName": {
      "type": "string",
      "description": "Display name for the realm"
    },
    "operatorRef": {
      "type": "object",
      "properties": {
        "namespace": {
          "type": "string",
          "description": "Namespace where the operator is running"
        }
      },
      "required": ["namespace"]
    },
    "clientAuthorizationGrants": {
      "type": "array",
      "description": "List of namespaces authorized to create clients in this realm",
      "items": {
        "type": "string"
      }
    },
    "security": {
      "type": "object",
      "properties": {
        "registrationAllowed": {"type": "boolean"},
        "registrationEmailAsUsername": {"type": "boolean"},
        "editUsernameAllowed": {"type": "boolean"},
        "resetPasswordAllowed": {"type": "boolean"},
        "rememberMe": {"type": "boolean"},
        "verifyEmail": {"type": "boolean"},
        "loginWithEmailAllowed": {"type": "boolean"},
        "duplicateEmailsAllowed": {"type": "boolean"},
        "bruteForceProtected": {"type": "boolean"},
        "permanentLockout": {"type": "boolean"},
        "maxFailureWait": {"type": "integer"},
        "minimumQuickLoginWait": {"type": "integer"},
        "waitIncrement": {"type": "integer"},
        "quickLoginCheckMillis": {"type": "integer"},
        "maxDeltaTime": {"type": "integer"},
        "failureFactor": {"type": "integer"}
      }
    },
    "themes": {
      "type": "object",
      "properties": {
        "login": {"type": "string"},
        "admin": {"type": "string"},
        "account": {"type": "string"},
        "email": {"type": "string"}
      }
    },
    "localization": {
      "type": "object",
      "properties": {
        "defaultLocale": {"type": "string"},
        "supportedLocales": {
          "type": "array",
          "items": {"type": "string"}
        },
        "enabled": {"type": "boolean"}
      }
    },
    "tokenSettings": {
      "type": "object",
      "properties": {
        "accessTokenLifespan": {"type": "integer"},
        "accessTokenLifespanForImplicitFlow": {"type": "integer"},
        "ssoSessionIdleTimeout": {"type": "integer"},
        "ssoSessionMaxLifespan": {"type": "integer"},
        "offlineSessionIdleTimeout": {"type": "integer"},
        "offlineSessionMaxLifespanEnabled": {"type": "boolean"},
        "offlineSessionMaxLifespan": {"type": "integer"},
        "clientSessionIdleTimeout": {"type": "integer"},
        "clientSessionMaxLifespan": {"type": "integer"}
      }
    },
    "smtpServer": {
      "type": "object",
      "properties": {
        "enabled": {"type": "boolean"},
        "host": {"type": "string"},
        "port": {"type": "integer"},
        "from": {"type": "string"},
        "fromDisplayName": {"type": "string"},
        "replyTo": {"type": "string"},
        "envelopeFrom": {"type": "string"},
        "ssl": {"type": "boolean"},
        "starttls": {"type": "boolean"},
        "auth": {"type": "boolean"},
        "user": {"type": "string"},
        "passwordSecret": {
          "type": "object",
          "properties": {
            "name": {"type": "string"},
            "key": {"type": "string"}
          }
        }
      }
    },
    "attributes": {
      "type": "object",
      "additionalProperties": {"type": "string"}
    },
    "description": {
      "type": "string",
      "description": "Realm description"
    },
    "loginPageTitle": {
      "type": "string",
      "description": "HTML title for login pages"
    },
    "identityProviders": {
      "type": "array",
      "description": "External identity providers (OIDC, SAML, social logins)",
      "items": {
        "type": "object",
        "properties": {
          "alias": {
            "type": "string",
            "description": "Identity provider alias (unique identifier)"
          },
          "providerId": {
            "type": "string",
            "description": "Provider type (e.g., oidc, saml, github, google)"
          },
          "displayName": {
            "type": "string",
            "description": "Display name for the identity provider"
          },
          "enabled": {
            "type": "boolean",
            "description": "Whether the provider is enabled"
          },
          "trustEmail": {
            "type": "boolean",
            "description": "Trust email from identity provider"
          },
          "storeToken": {
            "type": "boolean",
            "description": "Store identity provider tokens"
          },
          "linkOnly": {
            "type": "boolean",
            "description": "Link existing users only"
          },
          "firstBrokerLoginFlowAlias": {
            "type": "string",
            "description": "First broker login flow alias"
          },
          "postBrokerLoginFlowAlias": {
            "type": "string",
            "description": "Post broker login flow alias"
          },
          "config": {
            "type": "object",
            "description": "Provider-specific configuration",
            "additionalProperties": true
          },
          "configSecrets": {
            "type": "object",
            "description": "Secret references for sensitive config values",
            "additionalProperties": {
              "type": "object",
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Secret name"
                },
                "key": {
                  "type": "string",
                  "description": "Key in secret data"
                }
              },
              "required": ["name", "key"]
            }
          }
        },
        "required": ["alias", "providerId"]
      }
    },
    "roles": {
      "type": "object",
      "description": "Realm role definitions",
      "properties": {
        "realmRoles": {
          "type": "array",
          "description": "List of realm roles",
          "items": {
            "type": "object",
            "properties": {
              "name": {
                "type": "string",
                "description": "Role name"
              },
              "description": {
                "type": "string",
                "description": "Role description"
              },
              "composite": {
                "type": "boolean",
                "description": "Is composite role"
              }
            },
            "required": ["name"]
          }
        }
      }
    },
    "eventsConfig": {
      "type": "object",
      "description": "Event logging configuration",
      "properties": {
        "eventsEnabled": {
          "type": "boolean",
          "description": "Enable event logging"
        },
        "adminEventsEnabled": {
          "type": "boolean",
          "description": "Enable admin event logging"
        },
        "adminEventsDetailsEnabled": {
          "type": "boolean",
          "description": "Include details in admin events"
        },
        "eventsListeners": {
          "type": "array",
          "description": "Event listeners",
          "items": {"type": "string"}
        },
        "enabledEventTypes": {
          "type": "array",
          "description": "Enabled event types",
          "items": {"type": "string"}
        },
        "eventsExpiration": {
          "type": "integer",
          "description": "Event expiration in seconds"
        }
      }
    },
    "extraManifests": {
      "type": "array",
      "description": "Extra Kubernetes manifests to deploy (e.g., ExternalSecrets, SealedSecrets, ConfigMaps)",
      "items": {
        "type": "object",
        "description": "A Kubernetes manifest in YAML format"
      }
    },
    "commonLabels": {
      "type": "object",
      "additionalProperties": {"type": "string"}
    },
    "commonAnnotations": {
      "type": "object",
      "additionalProperties": {"type": "string"}
    },
    "rbac": {
      "type": "object",
      "description": "RBAC configuration for operator access to this namespace",
      "properties": {
        "create": {
          "type": "boolean",
          "description": "Create RoleBinding for operator access to secrets in this namespace",
          "default": true
        },
        "operatorClusterRoleName": {
          "type": "string",
          "description": "Name of the operator's ClusterRole for namespace access",
          "default": "keycloak-operator-namespace-access"
        },
        "operatorServiceAccountName": {
          "type": "string",
          "description": "Override for operator's ServiceAccount name"
        }
      }
    }
  }
}
